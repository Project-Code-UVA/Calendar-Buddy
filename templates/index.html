{% extends "base.html" %}

{% block title %}Home Page{% endblock title %}

{% block body %}

<section id="upload-section" class="section">
    <h2>Upload New File</h2>
    <form method="post" enctype="multipart/form-data" class="upload-form">
        <input type="file" name="file" accept=".pdf, .txt, image/*">
        <button type="submit" class="btn">Upload</button>
    </form>
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}
</section>

<section id="calendar-section" class="section">
    <h2>Calendar</h2>
    <ul>
        {% for file in uploaded_files %}
        {% if file.extractedEvent %}
        <li>
            <strong>{{ file.extractedEvent.title }}</strong> â€”
            {{ file.extractedEvent.date.strftime("%Y-%m-%d") }}
        </li>
        {% endif %}
        {% endfor %}
        {% if not uploaded_files %}
        <li>No events uploaded yet.</li>
        {% endif %}
    </ul>
</section>

<section id="history-section" class="section">
    <h2>Upload History</h2>
    <ul>
        {% for file in uploaded_files %}
        <li>
            {{ file.filename }}
            <a href="{{ url_for('download_file', filename=file.filename) }}" class="btn-link">Download</a>
            <a href="{{ url_for('delete_file', file_id=file.id) }}" class="btn-link">Delete</a>
        </li>
        {% endfor %}
        {% if not uploaded_files %}
        <li>No files uploaded yet.</li>
        {% endif %}
    </ul>
</section>

{% endblock body %}
